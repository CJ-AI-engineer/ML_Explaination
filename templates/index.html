<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Step-by-Step ML Visualizer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header><h1>Step-by-Step ML Visualizer</h1></header>
    <main>
        <form method="POST" action="{{ url_for('results') }}" id="ml-form">
            <h2>Step 1: Select Configuration</h2>
            
            <div class="form-group">
                <label for="algorithm">Select Algorithm:</label>
                <select name="algorithm" id="algorithm" required>
                    <option value="" disabled selected>--- Choose Algorithm ---</option>
                    {% for key, name in algorithms.items() %}
                        <option value="{{ key }}">{{ name }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group">
                <label for="dataset">Select Dataset:</label>
                <select name="dataset" id="dataset" required>
                    <option value="" disabled selected>--- Choose Dataset ---</option>
                    {% for key, name in datasets.items() %}
                        <option value="{{ key }}">{{ name }}</option>
                    {% endfor %}
                </select>
            </div>

            <h2>Step 2: Configure Parameters</h2>
            <div id="parameter-group">
                
                <div id="params-knn" class="param-card hidden">
                    <h3>K-Nearest Neighbors</h3>
                    <label for="knn_neighbors">K (Number of Neighbors):</label>
                    <input type="number" id="knn_neighbors" name="knn_neighbors" value="5" min="1" required>
                </div>

                <div id="params-tree" class="param-card hidden">
                    <h3>Tree-Based Algorithms</h3>
                    <label for="tree_depth">Max Depth (for DT/RF):</label>
                    <input type="number" id="tree_depth" name="tree_depth" value="3" min="1" required>
                </div>

                <div id="params-rf" class="param-card hidden">
                    <label for="rf_estimators">Number of Trees (N_estimators):</label>
                    <input type="number" id="rf_estimators" name="rf_estimators" value="5" min="1" required>
                </div>
                
                <div id="params-lr" class="param-card hidden">
                    <h3>Logistic Regression (Gradient Descent)</h3>
                    <label for="lr_max_iter">Max Iterations:</label>
                    <input type="number" id="lr_max_iter" name="lr_max_iter" value="200" min="10" required>
                    <label for="lr_rate">Learning Rate (e.g., 0.01):</label>
                    <input type="number" id="lr_rate" name="lr_rate" value="0.01" step="0.001" min="0.001" required>
                </div>

                <div id="params-kmeans" class="param-card hidden">
                    <h3>K-Means Clustering</h3>
                    <label for="kmeans_clusters">K (Number of Clusters):</label>
                    <input type="number" id="kmeans_clusters" name="kmeans_clusters" value="3" min="2" required>
                </div>

            </div>
            <button type="submit">Start Visualization</button>
        </form>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const algoSelect = document.getElementById('algorithm');
            const paramCards = document.querySelectorAll('.param-card');

            const toggleParams = (selectedAlgo) => {
                // 1. Hide all parameter cards
                paramCards.forEach(card => card.classList.add('hidden'));

                // 2. Show relevant cards
                if (selectedAlgo === 'knn') {
                    document.getElementById('params-knn').classList.remove('hidden');
                } else if (selectedAlgo === 'dt') {
                    document.getElementById('params-tree').classList.remove('hidden');
                } else if (selectedAlgo === 'rf') {
                    document.getElementById('params-tree').classList.remove('hidden');
                    document.getElementById('params-rf').classList.remove('hidden');
                } else if (selectedAlgo === 'lr') {
                    document.getElementById('params-lr').classList.remove('hidden');
                } else if (selectedAlgo === 'kmeans') {
                    document.getElementById('params-kmeans').classList.remove('hidden');
                }
            };

            // Event listener for algorithm change
            algoSelect.addEventListener('change', (event) => {
                toggleParams(event.target.value);
            });

            // Initial call in case a value is pre-selected (though not likely here)
            toggleParams(algoSelect.value);
        });
    </script>
</body>
</html>
